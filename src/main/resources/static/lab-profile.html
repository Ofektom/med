<!DOCTYPE html>
<html lang="en">

<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=UTF-8" /><!-- /Added by HTTrack -->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>EMR Lab Scientist Profile</title>
  <link rel="icon" type="image/x-icon" href="/includes/images/favicon.ico">
  <link rel="stylesheet" href="/assets/css/bootstrap-icons.css">
  <link rel="stylesheet" href="/assets/css/responsive.bootstrap5.min.css">
  <link rel="stylesheet" href="/assets/css/dataTables.bootstrap5.min.css">
  <link rel="stylesheet" href="/assets/css/bootstrap-datepicker.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
  <link rel="stylesheet" href="/assets/css/bootstrap.css">
  <link rel="stylesheet" href="/assets/css/style.css">
</head>

<body>
  <div id="preloader"></div>

  <div class="d-flex body-main body-color" id="wrapper">
    <!-- backdrop -->
    <div class="sidebar-backdrop"></div>
    <div class="sidebar-main">
      <div class="sidebar h-100 bg-dark-primary close" id="sidebar-wrapper">
        <div class="sidebar-box text-center position-fixed slim-outer bg-dark-primary">
          <div class="sidebar-heading bg-dark d-flex align-items-center justify-content-between p-3 border-dark border-bottom">
            <a href="/index.html">
              <img src="/includes/images/healthcare-logo.png" width="200" alt="">
            </a>
            <button class="btn btn-primary rounded closesidebar d-lg-none btn-sm"> <i class="fa-solid fa-xmark text-white"></i></button> 
          </div>
          <div class="sidebar-box-data text-start px-3" id="sidebar-data">
            <div class="list-group list-group-flush mt-3">
              <div class="accordion" id="accordionExampleOne"> 
                <div class="accordion-item mb-4">
                  <a href="/lab-dashboard.html" class="active no-arrow rounded accordion-button p-2 fw-600 text-white mb-0 d-flex align-items-center">
                    <i class="bi bi-grid-1x2-fill px-2"></i><span>LAB Dashboard</span>
                  </a>
                </div>
                <div class="accordion-item mb-4">
                    <a href="/lab-appointmentlist.html" class="no-arrow rounded accordion-button p-2 fw-600 text-white mb-0 d-flex align-items-center">
                      <i class="fa-regular fa-address-book px-2"></i>Appointments
                    </a>
                </div>
                <div class="accordion-item mb-4">
                  <a href="/lab-patientlist.html" class="no-arrow rounded accordion-button p-2 fw-600 text-white mb-0 d-flex align-items-center">
                    <i class="fa-regular fa-address-book px-2"></i>Patients
                  </a>
                </div>
                <div class="accordion-item mb-4">
                  <a href="/lab-reports.html" class="no-arrow rounded accordion-button p-2 fw-600 text-white mb-0 d-flex align-items-center">
                    <i class="bi bi-file-earmark-pdf-fill px-2"></i> <span>Reports</span>
                  </a>
                </div>
                <div class="accordion-item mb-4">
                  <a href="/lab-prescriptionlist.html" class="no-arrow rounded accordion-button p-2 fw-600 text-white mb-0 d-flex align-items-center">
                    <i class="fa-solid fa-timeline px-2"></i>Prescriptions
                  </a>
                </div>
                <div class="accordion-item mb-4 d-block d-sm-none">
                  <div class="accordion-header" id="headingSeven">
                    <button class="accordion-button p-2 collapsed text-white mb-0 d-flex align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSeven" aria-expanded="true" aria-controls="collapseSeven">
                      <i class="bi bi-bell-fill text-white px-2"></i><span class="fw-600">Notification</span>
                    </button>
                  </div>
                  <div id="collapseSeven" class="accordion-collapse collapse" aria-labelledby="headingSeven" data-bs-parent="#accordionExampleOne">
                    <div class="accordion-body">
                      <div class="slim-outer">
                        <div class="card border-0 shadow bg-white rounded-2 overflow-hidden" id="mobile-notifications">
                          <ul class="list-unstyled text-dark-primary mb-0 click-menu"></ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="accordion-item mb-4 d-block d-sm-none">
                  <div class="accordion-header" id="headingEight">
                    <button class="accordion-button p-2 collapsed text-white mb-0 d-flex align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#collapseEight" aria-expanded="true" aria-controls="collapseEight">
                      <i class="bi bi-envelope-fill text-white px-2"></i><span class="fw-600">Messages</span>
                    </button>
                  </div>
                  <div id="collapseEight" class="accordion-collapse collapse" aria-labelledby="headingEight" data-bs-parent="#accordionExampleOne">
                    <div class="accordion-body">
                      <div class="slim-outer">
                        <div class="card border-0 shadow bg-white rounded-2 overflow-hidden" id="mobile-messages">
                          <ul class="list-unstyled text-dark-primary mb-0 click-menu"></ul>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
                <div class="accordion-item mb-4">
                  <div class="accordion-header" id="headingSeven">
                    <button class="accordion-button p-2 collapsed text-white mb-0 d-flex align-items-center" type="button" data-bs-toggle="collapse" data-bs-target="#collapseSeven" aria-expanded="true" aria-controls="collapseSeven">
                      <i class="fa-solid fa-user-shield px-2"></i>Setting
                    </button>
                  </div>
                  <div id="collapseSeven" class="accordion-collapse collapse" aria-labelledby="headingSeven" data-bs-parent="#accordionExampleOne">
                    <div class="accordion-body">
                      <ul class="navbar-nav d-block">
                        <li class="nav-item mb-2 rounded-3 px-3"><a class="nav-link fs-14 text-white" href="/admin-profile.html">Profile</a></li>
                        <li class="nav-item mb-2 rounded-3 px-3"><a class="nav-link fs-14 text-white" href="/resetpass.html">Reset Password</a></li>
                      </ul>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
    <div id="page-content-wrapper" class="position-relative">
      <div class="bg-white shadow-sm px-3 py-2 mb-4 header m-auto position-fixed">
        <div class="row align-items-center">
          <div class="row flex-row-reverse justify-content-between align-items-center">
            <div class="col-lg-6">
              <div class="d-flex justify-content-lg-end justify-content-between align-items-center gap-2">
                <div class="d-block d-lg-none">
                  <button class="btn shadow-0 focus-0 sidebar-btn rounded border-0 sidebarToggle">
                    <img src="/includes/images/menu-icons.svg" alt="">
                  </button>
                  <a href="/lab-dashboard.html">
                    <img src="/includes/images/ERP-Logo(1).png" width="180" alt="">
                  </a>
                </div>
                <div class="d-flex align-items-center">
                  <div class="maximize d-none d-lg-block">
                    <a class="badge-purple d-flex align-items-center text-primary" href="javascript:void(0)" id="fullscreen">
                    </a>
                  </div>
                  <div class="position-relative rounded d-lg-none">
                    <a class="text-primary py-2 px-3 btn btn-transparent outline-0 focus-0 rounded btn-cust-sm"
                      data-bs-toggle="collapse" href="#searchcollapse" role="button" aria-expanded="false"
                      aria-controls="searchcollapse">
                      <i class="bi bi-search"></i>
                    </a>
                    <div class="collapse position-absolute top-100 mt-2 end-0 z-3 mw-250 mw-100" id="searchcollapse">
                      <div class="card card-body">
                        <form>
                          <div class="border bg-light position-relative h-100 d-flex align-items-center header-search mw-100">
                            <button class="btn btn-transparent border-0 position-absolute ms-1">
                              <img src="/includes/images/search2.svg" alt="">
                            </button>
                            <input type="search" class="form-control border-0 bg-transparent shadow-none ps-5 py-2"
                              placeholder="Search here..">
                          </div>
                        </form>
                      </div>
                    </div>
                  </div>
                  <div class="dropdown d-none d-sm-block">
                    <button type="button" class="btn rounded position-relative" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      <i class="fa-solid fa-envelope fs-5 text-success pb-0 mb-0"></i>
                      <span class="msg-lite">
                        <span class="circles cust_circle">
                          <span class="circle1"></span>
                          <span class="circle2"></span>
                          <span class="circle3"></span>
                        </span>
                      </span>
                    </button>
                    <div class="dropdown-menu dropdown-notification dropdown-menu-end dropdown-mega p-0 border-0 rounded-10 bg-transparent">
                      <div class="animate slideIn">
                        <div class="card border-0 shadow bg-white rounded-10 overflow-hidden slim-outer">
                          <div class="bg-light p-3">
                            <h6 class="text-center mb-0">Messages</h6>
                          </div>
                          <ul class="list-unstyled text-dark-primary mb-0 click-menu px-2 py-3" id="message_box">
                            <!-- Populated dynamically via JavaScript -->
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="dropdown d-none d-sm-block">
                    <button type="button" class="btn rounded position-relative" data-bs-toggle="dropdown"
                      aria-expanded="false">
                      <i class="fa-solid fa-bell fs-5 text-orange pb-0 mb-0"></i>
                      <span class="notification-lite">
                        <span class="circles cust_circle">
                          <span class="circle1"></span>
                          <span class="circle2"></span>
                          <span class="circle3"></span>
                        </span>
                      </span>
                    </button>
                    <div class="dropdown-menu dropdown-notification dropdown-menu-end dropdown-mega p-0 border-0 rounded-10 bg-transparent">
                      <div class="animate slideIn">
                        <div class="card border-0 shadow bg-white rounded-10 overflow-hidden slim-outer slim-outer">
                          <div class="bg-light p-3">
                            <h6 class="text-center mb-0">Notifications</h6>
                          </div>
                          <ul class="list-unstyled text-dark-primary mb-0 click-menu px-2 py-3" id="notification_box">
                            <!-- Populated dynamically via JavaScript -->
                          </ul>
                        </div>
                      </div>
                    </div>
                  </div>
                  <div class="dropdown user">
                    <button type="button" class="pill-badge btn md-mw-150 me-xl-3 d-flex align-items-center text-start rounded px-0"
                      data-bs-toggle="dropdown" aria-expanded="false">
                      <img src="/includes/images/01_2.png" alt="" class="border rounded">
                      <span class="justify-content-between align-items-center gap-4 px-2 w-100 d-none d-xl-flex">
                        <span class="my-0 py-0 lh-1">
                          <span class="pill-badge-msg lh-sm text-capitalize pb-0 mb-0 d-block user-firstname"></span>
                          <span class="fs-12 p-0 d-block user-role"></span>
                        </span>
                        <span class="my-0 py-0">
                          <i class="bi bi-chevron-down"></i>
                        </span>
                      </span>
                    </button>
                    <div class="dropdown-menu dropdown-menu-end dropdown-mega p-0 border-0 rounded-3 bg-transparent">
                      <div class="animate slideIn">
                        <div class="card bg-white rounded-10 shadow-sm overflow-hidden">
                          <div class="bg-light p-3">
                            <h6 class="mb-0 fs-14 fw-500 mb-1 dropdown-user-greeting"></h6>
                            <p class="mb-0 fs-12 fw-500 user-status"></p>
                          </div>
                          <ul class="list-unstyled text-dark-primary mb-0 click-menu p-3">
                            <li class="py-3 px-2 rounded-end-3">
                              <a href="/lab-profile.html">
                                <div class="d-flex align-items-center">
                                  <div class="rounded bg-light reward-circle d-flex align-items-center justify-content-center me-3 text-center">
                                    <i class="fa fa-user fs-5 text-primary"></i>
                                  </div>
                                  <div>
                                    <h6 class="text-dark fs-14 mb-0">My Profile</h6>
                                    <p class="text-light fs-12 mb-0">View Profile Details</p>
                                  </div>
                                </div>
                              </a>
                            </li>
                          </ul>
                          <div class="mb-2 text-center">
                            <a class="btn btn-primary btn-15 rounded-pill mw-120 logout-btn">Logout <i class="fa fa-sign-out"></i></a>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
            <div class="col-6 d-none d-lg-block">
              <div class="d-lg-flex align-items-center">
                <button class="btn shadow-0 focus-0 d-none d-lg-block sidebar-btn rounded border-0 sidebarToggle">
                  <img src="/includes/images/menu-icons.svg" alt="">
                </button>
                <form id="desktop-search-form" class="d-none d-lg-block mw-200 position-relative">
                  <div class="bg-light-blue position-relative h-100 d-flex align-items-center header-search rounded-10">
                    <button class="btn btn-transparent border-0 position-absolute top-0">
                      <img src="/includes/images/search2.svg" alt="">
                    </button>
                    <input type="search" class="form-control border-0 bg-transparent shadow-none ps-5 py-2 desktop-search-input" placeholder="Search rooms..">
                  </div>
                  <div id="desktop-search-results" class="position-absolute top-100 mt-2 start-0 end-0 z-3 bg-white shadow rounded-3" style="display: none;">
                    <ul class="list-unstyled text-dark-primary mb-0 click-menu"></ul>
                  </div>
                </form>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="px-4 mb-4 min-vh-100 outer-main">
        <h3 class="fw-600 text-dark-primary text-capitalize">Lab Scientist profile</h3>
        <div class="d-flex flex-wrap justify-content-between align-items-center my-3">
          <div class="d-flex flex-wrap text-capitalize align-items-center">
            <p class="mb-0 pb-0 fw-600 text-dark-primary"><a href="/lad-dashboard.html">Home</a></p>
            <i class="bi bi-chevron-right pagination-arrow text-dark-primary"></i>
            <p class="mb-0 pb-0 text-dark">Lab Scientist Profile</p>
          </div>
        </div>
        <div class="bg-white rounded-10 mb-4 overflow-hidden">
          <div class="doct-profile-banner"></div>
          <div class="row align-items-center py-3">
            <div class="col-lg-4 mb-4 mb-lg-0">
              <div class="d-flex flex-wrap px-4">
                <div class="doct-profile-img me-3">
                  <img src="/includes/images/01_2.png" alt="" width="100" height="100" class="rounded-circle" id="profilePicture">
                </div>
                <div class="doctor-name d-flex flex-column justify-content-center m-1">
                  <h5 class="text-primary mb-1" id="doctorFullName"></h5>
                  <span class="fs-14 text-light" id="doctorDesignation"></span>
                </div>
              </div>
            </div>
            <div class="col-lg-8 px-4 px-lg-0">
              <div class="row align-items-center justify-content-end px-4" id="doctorStats">
                <!-- Stats will be populated dynamically -->
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-md-6 col-lg-4">
            <div class="border-0 shadow-sm py-3 mb-4 bg-white rounded-10 slim-outer px-3">
              <div class="card-header bg-transparent mb-3">
                <h5 class="text-dark text-capitalize text-gray">Speciality</h5>
              </div>
              <div class="card-body" id="speciality_box">
                <!-- Specialities will be populated dynamically -->
              </div>
            </div>
            <div class="border-0 shadow-sm py-3 mb-4 bg-white rounded-10 slim-outer px-3">
              <div class="card-header bg-transparent mb-3">
                <h5 class="text-dark text-capitalize text-gray">Activities</h5>
              </div>
              <div class="card-body px-2" id="activity_box">
                <div id="content">
                  <ul class="timeline-1 text-black" id="activity_list">
                    <!-- Activities will be populated dynamically -->
                  </ul>
                </div>
              </div>
            </div>
            <div class="border-0 shadow-sm py-3 mb-4 bg-white rounded-10 slim-outer px-3">
              <div class="card-header bg-transparent mb-3">
                <h5 class="text-dark text-capitalize text-gray">Patient Notes</h5>
              </div>
              <div class="card-body" id="pat_notes">
                <ul class="list-unstyled click-menu">
                  <!-- Patient notes will be populated dynamically -->
                </ul>
              </div>
            </div>
            <div class="border-0 shadow-sm py-3 mb-4 bg-white rounded-10 slim-outer px-3">
              <div class="card-header bg-transparent mb-3">
                <h5 class="text-dark text-capitalize text-gray">Schedule</h5>
              </div>
              <div class="card-body" id="schedule-box">
                <!-- Schedules will be populated dynamically -->
              </div>
            </div>
          </div>
          <div class="col-md-6 col-lg-8">
            <div class="bg-white shadow-sm rounded-10 h-100 py-4">
              <nav>
                <div class="nav nav-tabs" id="nav-tab" role="tablist">
                  <button class="nav-link active" id="personal-tab" data-bs-toggle="tab" data-bs-target="#nav-personal"
                    type="button" role="tab" aria-controls="nav-personal" aria-selected="true">Personal
                    Information</button>
                  <button class="nav-link" id="password-tab" data-bs-toggle="tab" data-bs-target="#nav-password"
                    type="button" role="tab" aria-controls="nav-password" aria-selected="false">Account
                    Settings</button>
                </div>
              </nav>
              <div class="tab-content" id="nav-tabContent">
                <div class="tab-pane fade show active" id="nav-personal" role="tabpanel" aria-labelledby="personal-tab">
                  <div class="p-4">
                    <form id="edit_personal_info">
                      <div class="row">
                        <div class="col-sm-6 mb-3 col-xxl-3">
                          <h6 class="text-dark mb-2">Full Name</h6>
                          <span class="text-gray d-block" id="fullName"></span>
                        </div>
                        <div class="col-sm-6 mb-3 col-xxl-3">
                          <h6 class="text-dark mb-2">Mobile</h6>
                          <input type="text" class="form-control rounded" name="phoneNumber" id="phoneNumberInput">
                        </div>
                        <div class="col-sm-6 mb-3 col-xxl-3">
                          <h6 class="text-dark mb-2">Email</h6>
                          <span class="text-gray d-block" id="email"></span>
                        </div>
                        <div class="col-sm-6 mb-3 col-xxl-3">
                          <h6 class="text-dark mb-2">Membership No</h6>
                          <span class="text-gray d-block" id="membershipNo"></span>
                        </div>
                        <div class="col-sm-6 mb-3 col-xxl-3">
                          <h6 class="text-dark mb-2">Location</h6>
                          <textarea class="form-control rounded" name="location" id="locationInput"></textarea>
                        </div>
                        <div class="col-sm-6 mb-3 col-xxl-3">
                          <h6 class="text-dark mb-2">About</h6>
                          <textarea class="form-control rounded" name="about" id="aboutInput"></textarea>
                        </div>
                      </div>
              
                      <div class="d-flex justify-content-between align-items-center border-bottom p-3">
                        <h5 class="mb-0">Education</h5>
                        <button type="button" class="btn btn-link text-primary toggle-add-education" style="font-size: 14px;">Add Education</button>
                      </div>
                      <div id="education_fields" class="p-3"></div>
                      <div id="education_add_form" style="display: none;" class="p-3 border-top">
                        <div class="row mb-3 education-entry" data-index="new">
                          <div class="col-sm-3">
                            <input type="text" class="form-control rounded" name="education_year_new" placeholder="Year">
                          </div>
                          <div class="col-sm-3">
                            <input type="text" class="form-control rounded" name="education_degree_new" placeholder="Degree">
                          </div>
                          <div class="col-sm-3">
                            <input type="text" class="form-control rounded" name="education_institute_new" placeholder="Institute">
                          </div>
                          <div class="col-sm-2">
                            <input type="text" class="form-control rounded" name="education_result_new" placeholder="Result">
                          </div>
                          <div class="col-sm-1">
                            <button type="button" class="btn btn-primary add-education-submit">Add</button>
                          </div>
                        </div>
                      </div>
              
                      <div class="d-flex justify-content-between align-items-center border-bottom p-3">
                        <h5 class="mb-0">Experience</h5>
                        <button type="button" class="btn btn-link text-primary toggle-add-experience" style="font-size: 14px;">Add Experience</button>
                      </div>
                      <div id="experience_fields" class="p-3"></div>
                      <div id="experience_add_form" style="display: none;" class="p-3 border-top">
                        <div class="row mb-3 experience-entry" data-index="new">
                          <div class="col-sm-2">
                            <input type="text" class="form-control rounded" name="experience_year_new" placeholder="Year">
                          </div>
                          <div class="col-sm-2">
                            <input type="text" class="form-control rounded" name="experience_department_new" placeholder="Department">
                          </div>
                          <div class="col-sm-2">
                            <input type="text" class="form-control rounded" name="experience_position_new" placeholder="Position">
                          </div>
                          <div class="col-sm-2">
                            <input type="text" class="form-control rounded" name="experience_hospital_new" placeholder="Hospital">
                          </div>
                          <div class="col-sm-2">
                            <input type="text" class="form-control rounded" name="experience_feedback_new" placeholder="Feedback">
                          </div>
                          <div class="col-sm-1">
                            <button type="button" class="btn btn-primary add-experience-submit">Add</button>
                          </div>
                        </div>
                      </div>
              
                      <div class="d-flex justify-content-between align-items-center border-bottom p-3">
                        <h5 class="mb-0">Conferences, Courses & Workshops</h5>
                        <button type="button" class="btn btn-link text-primary toggle-add-conference" style="font-size: 14px;">Add Conference</button>
                      </div>
                      <div id="conference_fields" class="p-3"></div>
                      <div id="conference_add_form" style="display: none;" class="p-3 border-top">
                        <div class="row mb-3 conference-entry" data-index="new">
                          <div class="col-sm-10">
                            <input type="text" class="form-control rounded" name="conference_new" placeholder="Conference Description">
                          </div>
                          <div class="col-sm-2">
                            <button type="button" class="btn btn-primary add-conference-submit">Add</button>
                          </div>
                        </div>
                      </div>
              
                      <div class="text-end mt-4">
                        <button type="submit" class="btn btn-primary mw-120 rounded-pill">Save Changes</button>
                      </div>
                    </form>
                  </div>
                </div>
                <div class="tab-pane fade" id="nav-password" role="tabpanel" aria-labelledby="nav-password">
                  <div class="p-4">
                    <form id="edit_doctor_profile">
                      <div class="mb-4">
                        <label for="membershipNo" class="text-dark mb-2">Membership Number <sup><span class="required">*</span></sup></label>
                        <input type="text" class="border form-control rounded" name="membershipNo" id="membershipNoInput">
                      </div>
                      <div class="mb-4">
                        <label for="mobile" class="text-dark mb-2">Mobile<sup><span class="required">*</span></sup></label>
                        <input type="text" class="border form-control rounded" name="mobile" id="mobileInput">
                      </div>
                      <div class="mb-4">
                        <label for="email" class="text-dark mb-2">Email<sup><span class="required">*</span></sup></label>
                        <input type="email" class="border form-control rounded" name="email" id="emailInput">
                      </div>
                      <div class="mb-4">
                        <label for="address" class="text-dark mb-2">Address<sup><span class="required">*</span></sup></label>
                        <textarea name="address" id="addressInput" rows="5" class="form-control rounded"></textarea>
                      </div>
                      <h4 class="text-dark fw-600 my-4">Security Setting</h4>
                      <div class="mb-4 custom-err">
                        <label for="pass" class="text-dark mb-2">Current Password<sup><span class="required">*</span></sup></label>
                        <input type="password" name="pass" id="pass" class="border form-control rounded">
                      </div>
                      <div class="mb-4 custom-err">
                        <label for="newpass" class="text-dark mb-2">New Password<sup><span class="required">*</span></sup></label>
                        <input type="password" id="newpass" name="newpass" class="border form-control rounded">
                      </div>
                      <div class="mb-4">
                        <label for="repeatpass" class="text-dark mb-2">Confirm Password<sup><span class="required">*</span></sup></label>
                        <input type="password" id="repeatpass" name="repeatpass" class="border form-control rounded">
                      </div>
                      <div class="text-end">
                        <button type="submit" class="btn btn-primary mw-120 rounded-pill">Change</button>
                      </div>
                    </form>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
      <div class="shadow-sm py-4 px-4 bg-white footer d-flex flex-wrap justify-content-between align-items-center fs-14">
        <div>
          <span id="currentYear"></span> © All Rights Reserved By Ofektom Technologies
        </div>
        <div>
          <a href="javascript:void(0)" class="text-primary text-decoration-underline fw-600">Privacy Policy</a> | 
          <a href="javascript:void(0)" class="text-primary text-decoration-underline fw-600">Terms & Conditions</a>
        </div>
      </div>
    </div>
  </div>
  <div class="modal fade" id="patnotes" tabindex="-1" aria-labelledby="patnotesLabel" aria-hidden="true">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <h5 class="modal-title" id="modalPatientName"></h5>
          <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
        </div>
        <div class="modal-body">
          <p id="modalPatientNote"></p>
        </div>
        <div class="modal-footer">
          <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        </div>
      </div>
    </div>
  </div>

  <script src="/assets/js/jquery-3.7.0.js"></script>
  <script src="/assets/js/jquery.min.js"></script>
  <script src="/assets/js/popper.min.js"></script>
  <script src="/assets/js/bootstrap.min.js"></script>
  <script src="/assets/js/jquery.dataTables.min.js"></script>
  <script src="/assets/js/dataTables.bootstrap5.min.js"></script>
  <script src="/assets/js/dataTables.responsive.min.js"></script>
  <script src="/assets/js/apexcharts.js"></script>
  <script src="/assets/js/jquery.validate.js"></script>
  <script src="/assets/js/bootstrap-datepicker.min.js"></script>
  <script src="/assets/js/jquery.slimscroll.min.js"></script>
  <script src="/assets/js/togglepassword.js"></script>
  <script src="/assets/js/all.min.js"></script>
  <script src="/assets/js/script.js"></script>
  <script>
    $(document).ready(function() {
    let currentPage = 0;
    const token = localStorage.getItem('access_token');
    const userStatusElement = $('.user-status');
    let lastActivityTime = Date.now();
    const INACTIVITY_TIMEOUT = 30 * 60 * 1000;

    $(document).on('mousemove keydown click', function () {
        lastActivityTime = Date.now();
    });

    function checkInactivity() {
        const currentTime = Date.now();
        if (currentTime - lastActivityTime > INACTIVITY_TIMEOUT) {
            localStorage.removeItem('access_token');
            localStorage.removeItem('user');
            userStatusElement.text('Offline').removeClass('text-success text-warning').addClass('text-danger');
            alert('You have been inactive for too long. Please log in.');
            window.location.href = '/index.html';
        }
    }

    setInterval(checkInactivity, 60 * 1000);

    function updateUserStatus() {
        if (!token) {
            userStatusElement.text('Offline').removeClass('text-success text-warning').addClass('text-danger');
            setTimeout(() => {
                alert('No session found. Please log in.');
                window.location.href = '/index.html';
            }, 1000);
            return;
        }

        $.ajax({
            url: '/api/v1/auth/validate-token',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function (response) {
                if (response && response.data && response.data.status) {
                    const status = response.data.status;
                    if (status === 'Available') {
                        userStatusElement.text(status).removeClass('text-danger text-warning').addClass('text-success');
                    } else if (status === 'Offline') {
                        userStatusElement.text(status).removeClass('text-success text-warning').addClass('text-danger');
                        localStorage.removeItem('access_token');
                        localStorage.removeItem('user');
                        setTimeout(() => {
                            alert('Session invalid. Please log in again.');
                            window.location.href = '/index.html';
                        }, 1000);
                    } else if (status === 'Away') {
                        userStatusElement.text(status).removeClass('text-success text-danger').addClass('text-warning');
                        localStorage.removeItem('access_token');
                        localStorage.removeItem('user');
                        setTimeout(() => {
                            alert('Session expired. Please log in again.');
                            window.location.href = '/index.html';
                        }, 1000);
                    }
                } else {
                    userStatusElement.text('Offline').removeClass('text-success text-warning').addClass('text-danger');
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('user');
                    setTimeout(() => {
                        alert('Session invalid. Please log in again.');
                        window.location.href = '/index.html';
                    }, 1000);
                }
            },
            error: function (xhr) {
                if (xhr.status === 401) {
                    userStatusElement.text('Away').removeClass('text-success text-danger').addClass('text-warning');
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('user');
                    setTimeout(() => {
                        alert('Session expired. Please log in again.');
                        window.location.href = '/index.html';
                    }, 1000);
                } else {
                    userStatusElement.text('Offline').removeClass('text-success text-warning').addClass('text-danger');
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('user');
                    setTimeout(() => {
                        alert('Session invalid. Please log in again.');
                        window.location.href = '/index.html';
                    }, 1000);
                }
            }
        });
    }

    updateUserStatus();
    setInterval(updateUserStatus, 300000);

    const userData = JSON.parse(localStorage.getItem('user'));
    if (userData) {
        const userFirstName = userData.firstName || 'User';
        let userRole = userData.userRole || 'Unknown';
        userRole = userRole.replace('ROLE_', '').replace('_', ' ').toLowerCase();
        userRole = userRole.split(' ').map(word => word.charAt(0).toUpperCase() + word.slice(1)).join(' ');
        $('.user-firstname').text(userFirstName);
        $('.user-role').text(userRole);
        $('.dropdown-user-greeting').text(`Hello ${userFirstName}`);
        $('#userProfilePicture').attr('src', userData.profilePicture || 'includes/images/01_2.png');
    } else {
        console.warn('User data not found in localStorage. Redirecting to login page.');
        window.location.href = '/index.html';
        return;
    }

    $('#currentYear').text(new Date().getFullYear());

    const urlParams = new URLSearchParams(window.location.search);
    let userId = urlParams.get('id');
    if (!userId && userData && userData.id) {
        userId = userData.id;
    }

    if (!userId) {
        alert('No user ID provided.');
        return;
    }

    $.ajax({
        url: `/api/v1/users/${userId}`,
        type: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token
        },
        success: function(response) {
            if (response && response.data && response.data.user) {
                const user = response.data.user;
                const fullName = `${user.firstName || ''} ${user.lastName || ''}`.trim();
                const location = `${user.address?.city || ''}, ${user.address?.state || ''}, ${user.address?.country || ''}`.trim() || 'N/A';
                const profilePicture = user.profilePicture || 'includes/images/01_2.png';
                const designation = user.designation || 'N/A';

                $('#profilePicture').attr('src', profilePicture);
                $('#doctorFullName').text(fullName);
                $('#doctorDesignation').text(designation);
                $('#fullName').html(`<i class="bi bi-person-fill"></i> ${fullName}`);
                $('#phoneNumberInput').val(user.phoneNumber || '');
                $('#email').html(`<i class="bi bi-envelope-fill"></i> ${user.email || 'N/A'}`);
                $('#membershipNo').html(`<i class="bi bi-id-card-fill"></i> ${user.membershipNo || 'N/A'}`);
                $('#locationInput').val(location);
                $('#aboutInput').val(user.about || '');
                $('#membershipNoInput').val(user.membershipNo || '');
                $('#mobileInput').val(user.phoneNumber || '');
                $('#emailInput').val(user.email || '');
                $('#addressInput').val(user.address?.fullAddress || '');
            } else {
                alert('No user data found.');
            }
        },
        error: function(xhr) {
            handleAjaxError(xhr, 'Failed to load user details due to a network or server error.');
        }
    });

    let professionalDetails = { educations: [], experiences: [], conferences: [] };

    function fetchProfessionalDetails() {
        return new Promise((resolve, reject) => {
            $.ajax({
                url: `/api/v1/users/${userId}/professional-details`,
                type: 'GET',
                headers: {
                    'Authorization': 'Bearer ' + token
                },
                success: function(response) {
                    if (response && response.data) {
                        const data = response.data;
                        professionalDetails = {
                            educations: data.educations || [],
                            experiences: data.experiences || [],
                            conferences: data.conferences || []
                        };
                        renderProfessionalDetails();
                        resolve();
                    } else {
                        reject('No professional details found in response.');
                    }
                },
                error: function(xhr) {
                    handleAjaxError(xhr, 'Failed to load professional details due to a network or server error.');
                    reject('Failed to load professional details.');
                }
            });
        });
    }

    function renderProfessionalDetails() {
        const educationFields = $('#education_fields');
        educationFields.empty();
        if (professionalDetails.educations.length === 0) {
            educationFields.append('<p class="text-gray">No education added.</p>');
        } else {
            professionalDetails.educations.forEach((edu, index) => {
                educationFields.append(`
                    <div class="row mb-3 education-entry" data-index="${index}" data-id="${edu.id}">
                        <div class="col-sm-11">
                            <p class="mb-1"><strong>Year:</strong> ${edu.year || 'N/A'}</p>
                            <p class="mb-1"><strong>Degree:</strong> ${edu.degree || 'N/A'}</p>
                            <p class="mb-1"><strong>Institute:</strong> ${edu.institute || 'N/A'}</p>
                            <p class="mb-1"><strong>Result:</strong> ${edu.result || 'N/A'}</p>
                        </div>
                        <div class="col-sm-1 text-end">
                            <div class="dropdown">
                                <button class="btn btn-link text-dark" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="bi bi-three-dots-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item edit-education" href="#" data-index="${index}" data-id="${edu.id}">Update</a></li>
                                    <li><a class="dropdown-item delete-education" href="#" data-index="${index}" data-id="${edu.id}">Delete</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `);
            });
        }

        const experienceFields = $('#experience_fields');
        experienceFields.empty();
        if (professionalDetails.experiences.length === 0) {
            experienceFields.append('<p class="text-gray">No experience added.</p>');
        } else {
            professionalDetails.experiences.forEach((exp, index) => {
                experienceFields.append(`
                    <div class="row mb-3 experience-entry" data-index="${index}" data-id="${exp.id}">
                        <div class="col-sm-11">
                            <p class="mb-1"><strong>Year:</strong> ${exp.year || 'N/A'}</p>
                            <p class="mb-1"><strong>Department:</strong> ${exp.department || 'N/A'}</p>
                            <p class="mb-1"><strong>Position:</strong> ${exp.position || 'N/A'}</p>
                            <p class="mb-1"><strong>Hospital:</strong> ${exp.hospital || 'N/A'}</p>
                            <p class="mb-1"><strong>Feedback:</strong> ${exp.feedback || 'N/A'}</p>
                        </div>
                        <div class="col-sm-1 text-end">
                            <div class="dropdown">
                                <button class="btn btn-link text-dark" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="bi bi-three-dots-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item edit-experience" href="#" data-index="${index}" data-id="${exp.id}">Update</a></li>
                                    <li><a class="dropdown-item delete-experience" href="#" data-index="${index}" data-id="${exp.id}">Delete</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `);
            });
        }

        const conferenceFields = $('#conference_fields');
        conferenceFields.empty();
        if (professionalDetails.conferences.length === 0) {
            conferenceFields.append('<p class="text-gray">No conferences added.</p>');
        } else {
            professionalDetails.conferences.forEach((conf, index) => {
                let conferenceText = 'N/A';
                
                // Handle different data structures
                if (typeof conf === 'string') {
                    try {
                        // If conf is a JSON string, parse it
                        const parsedConf = JSON.parse(conf);
                        conferenceText = parsedConf.conference || 'N/A';
                    } catch (e) {
                        // If conf is a plain string (not JSON), use it directly
                        conferenceText = conf || 'N/A';
                    }
                } else if (typeof conf === 'object' && conf !== null) {
                    // If conf is already an object, access the conference property
                    conferenceText = conf.conference || 'N/A';
                }

                conferenceFields.append(`
                    <div class="row mb-3 conference-entry" data-index="${index}" data-id="${index}">
                        <div class="col-sm-11">
                            <p class="mb-1">${conferenceText}</p>
                        </div>
                        <div class="col-sm-1 text-end">
                            <div class="dropdown">
                                <button class="btn btn-link text-dark" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                                    <i class="bi bi-three-dots-vertical"></i>
                                </button>
                                <ul class="dropdown-menu">
                                    <li><a class="dropdown-item edit-conference" href="#" data-index="${index}" data-id="${index}">Update</a></li>
                                    <li><a class="dropdown-item delete-conference" href="#" data-index="${index}" data-id="${index}">Delete</a></li>
                                </ul>
                            </div>
                        </div>
                    </div>
                `);
            });
        }
    }

    function handleAjaxError(xhr, fallbackMessage) {
        let message = fallbackMessage;
        if (xhr.responseJSON) {
            if (xhr.status === 422 && xhr.responseJSON.errors) {
                const validationErrors = xhr.responseJSON.errors;
                if (validationErrors.detail) {
                    message = Object.values(validationErrors.detail).join(", ");
                } else {
                    message = validationErrors.error || "Validation failed.";
                }
            } else if (xhr.responseJSON.message) {
                message = xhr.responseJSON.message;
            }
        }

        if (xhr.status === 401) {
            message = 'Unauthorized: Please log in again.';
            localStorage.removeItem('access_token');
            localStorage.removeItem('user');
            setTimeout(() => {
                window.location.href = '/index.html';
            }, 1000);
        } else if (xhr.status === 403) {
            message = 'Forbidden: You do not have permission to perform this action.';
        }

        alert(message);
    }

    $('.add-education-submit').on('click', function() {
        const year = $('input[name="education_year_new"]').val().trim();
        const degree = $('input[name="education_degree_new"]').val().trim();
        const institute = $('input[name="education_institute_new"]').val().trim();
        const result = $('input[name="education_result_new"]').val().trim();
        const educationDto = { year, degree, institute, result };
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/education`,
            type: 'POST',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(educationDto),
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    $('#education_add_form').hide();
                    $('input[name^="education_"]').val('');
                    alert('Education added successfully.');
                } else {
                    alert('Failed to add education: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to add education due to a network or server error.');
            }
        });
    });

    $('.add-experience-submit').on('click', function() {
        const year = $('input[name="experience_year_new"]').val().trim();
        const department = $('input[name="experience_department_new"]').val().trim();
        const position = $('input[name="experience_position_new"]').val().trim();
        const hospital = $('input[name="experience_hospital_new"]').val().trim();
        const feedback = $('input[name="experience_feedback_new"]').val().trim();
        const experienceDto = { year, department, position, hospital, feedback };
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/experience`,
            type: 'POST',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(experienceDto),
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    $('#experience_add_form').hide();
                    $('input[name^="experience_"]').val('');
                    alert('Experience added successfully.');
                } else {
                    alert('Failed to add experience: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to add experience due to a network or server error.');
            }
        });
    });

    $('.add-conference-submit').on('click', function() {
        const conference = $('input[name="conference_new"]').val().trim();
        const conferenceDto = { conference };
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/conference`,
            type: 'POST',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(conferenceDto),
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    $('#conference_add_form').hide();
                    $('input[name="conference_new"]').val('');
                    alert('Conference added successfully.');
                } else {
                    alert('Failed to add conference: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to add conference due to a network or server error.');
            }
        });
    });

    $(document).on('click', '.edit-education', function(e) {
        e.preventDefault();
        const index = $(this).data('index');
        const id = $(this).data('id');
        const edu = professionalDetails.educations[index];
        const entry = $(this).closest('.education-entry');
        entry.html(`
            <div class="col-sm-3">
                <input type="text" class="form-control rounded" name="education_year_${index}" value="${edu.year || ''}">
            </div>
            <div class="col-sm-3">
                <input type="text" class="form-control rounded" name="education_degree_${index}" value="${edu.degree || ''}">
            </div>
            <div class="col-sm-3">
                <input type="text" class="form-control rounded" name="education_institute_${index}" value="${edu.institute || ''}">
            </div>
            <div class="col-sm-2">
                <input type="text" class="form-control rounded" name="education_result_${index}" value="${edu.result || ''}">
            </div>
            <div class="col-sm-1">
                <button type="button" class="btn btn-primary save-education" data-index="${index}" data-id="${id}">Save</button>
            </div>
        `);
    });

    $(document).on('click', '.save-education', function() {
        const index = $(this).data('index');
        const id = $(this).data('id');
        const year = $(`input[name="education_year_${index}"]`).val().trim();
        const degree = $(`input[name="education_degree_${index}"]`).val().trim();
        const institute = $(`input[name="education_institute_${index}"]`).val().trim();
        const result = $(`input[name="education_result_${index}"]`).val().trim();
        const educationDto = { year, degree, institute, result };
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/education/${id}`,
            type: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(educationDto),
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    alert('Education updated successfully.');
                } else {
                    alert('Failed to update education: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to update education due to a network or server error.');
            }
        });
    });

    $(document).on('click', '.delete-education', function(e) {
        e.preventDefault();
        const id = $(this).data('id');
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/education/${id}`,
            type: 'DELETE',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    alert('Education deleted successfully.');
                } else {
                    alert('Failed to delete education: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to delete education due to a network or server error.');
            }
        });
    });

    $(document).on('click', '.edit-experience', function(e) {
        e.preventDefault();
        const index = $(this).data('index');
        const id = $(this).data('id');
        const exp = professionalDetails.experiences[index];
        const entry = $(this).closest('.experience-entry');
        entry.html(`
            <div class="col-sm-2">
                <input type="text" class="form-control rounded" name="experience_year_${index}" value="${exp.year || ''}">
            </div>
            <div class="col-sm-2">
                <input type="text" class="form-control rounded" name="experience_department_${index}" value="${exp.department || ''}">
            </div>
            <div class="col-sm-2">
                <input type="text" class="form-control rounded" name="experience_position_${index}" value="${exp.position || ''}">
            </div>
            <div class="col-sm-2">
                <input type="text" class="form-control rounded" name="experience_hospital_${index}" value="${exp.hospital || ''}">
            </div>
            <div class="col-sm-2">
                <input type="text" class="form-control rounded" name="experience_feedback_${index}" value="${exp.feedback || ''}">
            </div>
            <div class="col-sm-1">
                <button type="button" class="btn btn-primary save-experience" data-index="${index}" data-id="${id}">Save</button>
            </div>
        `);
    });

    $(document).on('click', '.save-experience', function() {
        const index = $(this).data('index');
        const id = $(this).data('id');
        const year = $(`input[name="experience_year_${index}"]`).val().trim();
        const department = $(`input[name="experience_department_${index}"]`).val().trim();
        const position = $(`input[name="experience_position_${index}"]`).val().trim();
        const hospital = $(`input[name="experience_hospital_${index}"]`).val().trim();
        const feedback = $(`input[name="experience_feedback_${index}"]`).val().trim();
        const experienceDto = { year, department, position, hospital, feedback };
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/experience/${id}`,
            type: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(experienceDto),
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    alert('Experience updated successfully.');
                } else {
                    alert('Failed to update experience: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to update experience due to a network or server error.');
            }
        });
    });

    $(document).on('click', '.delete-experience', function(e) {
        e.preventDefault();
        const id = $(this).data('id');
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/experience/${id}`,
            type: 'DELETE',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    alert('Experience deleted successfully.');
                } else {
                    alert('Failed to delete experience: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to delete experience due to a network or server error.');
            }
        });
    });

    $(document).on('click', '.edit-conference', function(e) {
        e.preventDefault();
        const index = $(this).data('index');
        const id = $(this).data('id');
        const conf = professionalDetails.conferences[index];
        const entry = $(this).closest('.conference-entry');
        entry.html(`
            <div class="col-sm-10">
                <input type="text" class="form-control rounded" name="conference_${index}" value="${conf || ''}">
            </div>
            <div class="col-sm-2">
                <button type="button" class="btn btn-primary save-conference" data-index="${index}" data-id="${id}">Save</button>
            </div>
        `);
    });

    $(document).on('click', '.save-conference', function() {
        const index = $(this).data('index');
        const id = $(this).data('id');
        const conference = $(`input[name="conference_${index}"]`).val().trim();
        const conferenceDto = { conference };
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/conference/${id}`,
            type: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(conferenceDto),
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    alert('Conference updated successfully.');
                } else {
                    alert('Failed to update conference: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to update conference due to a network or server error.');
            }
        });
    });

    $(document).on('click', '.delete-conference', function(e) {
        e.preventDefault();
        const id = $(this).data('id');
        $.ajax({
            url: `/api/v1/users/${userId}/professional-details/conference/${id}`,
            type: 'DELETE',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function(response) {
                if (response.status_code === 200) {
                    fetchProfessionalDetails();
                    alert('Conference deleted successfully.');
                } else {
                    alert('Failed to delete conference: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to delete conference due to a network or server error.');
            }
        });
    });

    $('.toggle-add-education').on('click', function() {
        $('#education_add_form').toggle();
    });

    $('.toggle-add-experience').on('click', function() {
        $('#experience_add_form').toggle();
    });

    $('.toggle-add-conference').on('click', function() {
        $('#conference_add_form').toggle();
    });

    $('#edit_personal_info').on('submit', function(e) {
        e.preventDefault();
        const personalData = {
            phoneNumber: $('#phoneNumberInput').val().trim(),
            about: $('#aboutInput').val().trim(),
            address: {
                city: $('#locationInput').val().trim().split(',')[0] || '',
                state: $('#locationInput').val().trim().split(',')[1] || '',
                country: $('#locationInput').val().trim().split(',')[2] || ''
            }
        };

        $.ajax({
            url: `/api/v1/users/${userId}`,
            type: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(personalData),
            success: function(response) {
                if (response.status_code === 200) {
                    alert('Personal details updated successfully.');
                    if (response.data && response.data.user) {
                        localStorage.setItem('user', JSON.stringify(response.data.user));
                    }
                } else {
                    alert('Failed to update personal details: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to update personal details due to a network or server error.');
            }
        });
    });

    $('#edit_doctor_profile').on('submit', function(e) {
        e.preventDefault();
        const password = $('#pass').val().trim();
        const newPassword = $('#newpass').val().trim();
        const repeatPassword = $('#repeatpass').val().trim();
        if (newPassword !== repeatPassword) {
            alert('New passwords do not match.');
            return;
        }

        const updateData = {
            membershipNo: $('#membershipNoInput').val().trim(),
            phoneNumber: $('#mobileInput').val().trim(),
            email: $('#emailInput').val().trim(),
            address: {
                fullAddress: $('#addressInput').val().trim()
            },
            currentPassword: password,
            newPassword: newPassword
        };

        $.ajax({
            url: `/api/v1/users/${userId}/update-profile`,
            type: 'PUT',
            headers: {
                'Authorization': 'Bearer ' + token,
                'Content-Type': 'application/json'
            },
            data: JSON.stringify(updateData),
            success: function(response) {
                if (response.status_code === 200) {
                    alert('Account settings updated successfully.');
                    if (response.data && response.data.user) {
                        localStorage.setItem('user', JSON.stringify(response.data.user));
                    }
                } else {
                    alert('Failed to update account settings: ' + (response.message || 'Unknown error'));
                }
            },
            error: function(xhr) {
                handleAjaxError(xhr, 'Failed to update account settings due to a network or server error.');
            }
        });
    });

    $.ajax({
        url: `/api/v1/users/${userId}/stats`,
        type: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token
        },
        success: function(response) {
            if (response && response.data) {
                const stats = response.data;
                $('#doctorStats').html(`
                    <div class="col-4 mb-4 mb-md-0 col-md-2">
                        <div>
                            <span class="text-gray pb-3">Operations</span>
                            <h4 class="text-primary mb-0">${stats.operations || 0}</h4>
                        </div>
                    </div>
                    <div class="col-4 mb-4 mb-md-0 col-md-2">
                        <div>
                            <span class="text-gray pb-3">Hospitals</span>
                            <h4 class="text-primary mb-0">${stats.hospitals || 0}</h4>
                        </div>
                    </div>
                    <div class="col-4 mb-4 mb-md-0 col-md-2">
                        <div>
                            <span class="text-gray pb-3">Patients</span>
                            <h4 class="text-primary mb-0">${stats.patients || 0}</h4>
                        </div>
                    </div>
                    <div class="col-md-6">
                        <div class="justify-content-md-end d-flex flex-wrap gap-2">
                            <a href="#" class="btn btn-primary rounded-4 fw-500 py-2 rounded-pill mw-120 px-4 text-capitalize me-2">
                                <i class="fa fa-user-edit me-2"></i> Edit Profile
                            </a>
                            <button class="btn btn-secondary rounded-4 fw-500 py-2 rounded-pill px-4 text-capitalize me-2">
                                <i class="fa fa-share-alt me-2"></i> Share Profile
                            </button>
                        </div>
                    </div>
                `);
            }
        },
        error: function(xhr) {
            if (xhr.status === 401) {
                alert('Session expired. Please log in again.');
                localStorage.removeItem('access_token');
                localStorage.removeItem('user');
                window.location.href = '/index.html';
            }
        }
    });

    $.ajax({
        url: `/api/v1/users/${userId}/specialties`,
        type: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token
        },
        success: function(response) {
            if (response && response.data && Array.isArray(response.data)) {
                const specialties = response.data;
                const specialityBox = $('#speciality_box');
                specialityBox.empty();
                specialties.forEach(specialty => {
                    const badgeClass = specialty.level === 'Professional' ? 'badge-success text-success' :
                                    specialty.level === 'Certified' ? 'badge-orange text-orange' : 'badge-secondary text-info';
                    specialityBox.append(`
                        <div class="d-flex flex-wrap align-items-center py-2 mb-2 border-b-dashed">
                            <div class="rounded-circle ${badgeClass} reward-circle d-flex align-items-center justify-content-center me-3">
                                <i class="bi bi-trophy-fill"></i>
                            </div>
                            <div>
                                <h6 class="text-dark-primary mb-1">${specialty.level || 'N/A'}</h6>
                                <span class="text-gray">${specialty.description || 'N/A'}</span>
                            </div>
                        </div>
                    `);
                });
            }
        },
        error: function(xhr) {
            if (xhr.status === 401) {
                alert('Session expired. Please log in again.');
                localStorage.removeItem('access_token');
                localStorage.removeItem('user');
                window.location.href = '/index.html';
            }
        }
    });

    $.ajax({
        url: `/api/v1/users/${userId}/activities`,
        type: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token
        },
        success: function(response) {
            if (response && response.data && Array.isArray(response.data)) {
                const activities = response.data;
                const activityList = $('#activity_list');
                activityList.empty();
                activities.forEach(activity => {
                    activityList.append(`
                        <li class="event mb-3">
                            <h6 class="text-dark-primary mb-1">${activity.title || 'N/A'}</h6>
                            <span class="text-gray">${activity.description || 'N/A'}</span>
                        </li>
                    `);
                });
            }
        },
        error: function(xhr) {
            if (xhr.status === 401) {
                alert('Session expired. Please log in again.');
                localStorage.removeItem('access_token');
                localStorage.removeItem('user');
                window.location.href = '/index.html';
            }
        }
    });

    $.ajax({
        url: `/api/v1/users/${userId}/patient-notes`,
        type: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token
        },
        success: function(response) {
            if (response && response.data && Array.isArray(response.data)) {
                const notes = response.data;
                const patNotes = $('#pat_notes ul');
                patNotes.empty();
                notes.forEach(note => {
                    const badgeClass = note.status === 'Open' ? 'badge-success text-success' : 'badge-orange text-orange';
                    patNotes.append(`
                        <li class="py-2 px-3">
                            <a href="javascript:void(0)" data-bs-toggle="modal" data-bs-target="#patnotes" data-name="${note.patientName}" data-note="${note.content}">
                                <div class="d-flex align-items-center justify-content-between">
                                    <div class="text-dark poppins w-75">
                                        <span class="d-block text-capitalize text-dark fw-600 px-0 fs-14 mb-2">${note.patientName || 'N/A'}</span>
                                        <div class="w-100 text-truncate overflow-hidden fs-14">${note.content || 'N/A'}</div>
                                    </div>
                                    <div class="w-25 text-end">
                                        <div class="badge ${badgeClass} rounded-pill px-3">${note.status || 'N/A'}</div>
                                    </div>
                                </div>
                            </a>
                        </li>
                    `);
                });

                $('#patnotes').on('show.bs.modal', function (event) {
                    const button = $(event.relatedTarget);
                    const name = button.data('name');
                    const note = button.data('note');
                    $('#modalPatientName').text(name);
                    $('#modalPatientNote').text(note);
                });
            }
        },
        error: function(xhr) {
            if (xhr.status === 401) {
                alert('Session expired. Please log in again.');
                localStorage.removeItem('access_token');
                localStorage.removeItem('user');
                window.location.href = '/index.html';
            }
        }
    });

    $.ajax({
        url: `/api/v1/users/${userId}/schedules`,
        type: 'GET',
        headers: {
            'Authorization': 'Bearer ' + token
        },
        success: function(response) {
            if (response && response.data && Array.isArray(response.data)) {
                const schedules = response.data;
                const scheduleBox = $('#schedule-box');
                scheduleBox.empty();
                schedules.forEach(schedule => {
                    const badgeClass = schedule.patientType === 'New Patient' ? 'bg-primary' : 'bg-orange';
                    scheduleBox.append(`
                        <div class="py-2 mb-2 border-b-dashed">
                            <div class="fs-12 text-gray">${new Date(schedule.time).toLocaleString()}</div>
                            <div class="d-flex align-items-center justify-content-between">
                                <h6 class="text-dark-primary mb-1 fw-normal">${schedule.patientName || 'N/A'}</h6>
                                <div>
                                    <span class="custom-badge badge ${badgeClass} text-white align-items-center rounded-pill text-capitalize me-2">${schedule.patientType || 'N/A'}</span>
                                </div>
                            </div>
                        </div>
                    `);
                });
            }
        },
        error: function(xhr) {
            if (xhr.status === 401) {
                alert('Session expired. Please log in again.');
                localStorage.removeItem('access_token');
                localStorage.removeItem('user');
                window.location.href = '/index.html';
            }
        }
    });

    function performSearch(query, targetResults) {
        if (query.length < 3) {
            targetResults.hide();
            return;
        }

        $.ajax({
            url: `/api/v1/search/users?query=${encodeURIComponent(query)}&page=1&size=10`,
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function (response) {
                const resultsList = targetResults.find('ul');
                resultsList.empty();

                if (response.data && response.data.content && response.data.content.length > 0) {
                    response.data.content.forEach(user => {
                        resultsList.append(`
                            <li class="p-2 rounded-end-3">
                                <a href="/admin-profile.html?id=${user.id}">
                                    <div class="d-flex align-items-center notification-row">
                                        <div class="d-flex align-items-center text-center p-0 notification-user-img">
                                            <img src="${user.profilePicture || '/includes/images/01.jpg'}" width="48" height="48" alt="">
                                        </div>
                                        <div class="notification-content">
                                            <div class="text-dark mb-0 fw-500 notification-msg">
                                                <span class="text-dark fw-bold mb-0">${user.firstName || ''} ${user.lastName || ''}</span>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <div class="w-100 text-truncate fs-12 fw-500">${user.membershipNo || 'N/A'}</div>
                                                <p class="text-dark text-end mb-0 fs-12 fw-500">${user.email || 'N/A'}</p>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </li>
                        `);
                    });
                    targetResults.show();
                } else {
                    resultsList.append(`
                        <li class="p-2 rounded-end-3">
                            <div class="text-dark fs-12">No users found.</div>
                        </li>
                    `);
                    targetResults.show();
                }
            },
            error: function (xhr) {
                const resultsList = targetResults.find('ul');
                resultsList.empty();
                let message = 'Search failed.';
                if (xhr.status === 401) {
                    message = 'Unauthorized: Please log in again.';
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('user');
                    window.location.href = '/index.html';
                } else if (xhr.responseJSON && xhr.responseJSON.message) {
                    message = xhr.responseJSON.message;
                }
                resultsList.append(`
                    <li class="p-2 rounded-end-3">
                        <div class="text-dark fs-12">${message}</div>
                    </li>
                `);
                targetResults.show();
            }
        });
    }

    $('.desktop-search-input').on('input', function () {
        const query = $(this).val().trim();
        performSearch(query, $('#desktop-search-results'));
    });

    $('.mobile-search-input').on('input', function () {
        const query = $(this).val().trim();
        performSearch(query, $('#mobile-search-results'));
    });

    $(document).on('click', function (e) {
        if (!$(e.target).closest('#desktop-search-form').length && !$(e.target).closest('#mobile-search-form').length) {
            $('#desktop-search-results').hide();
            $('#mobile-search-results').hide();
        }
    });

    $('#desktop-search-form, #mobile-search-form').on('submit', function (e) {
        e.preventDefault();
    });

    function fetchNotifications() {
        $.ajax({
            url: '/api/v1/notifications',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function (response) {
                if (response && response.data && Array.isArray(response.data)) {
                    const notifications = response.data;
                    const notificationBox = $('#notification_box');
                    const mobileNotifications = $('#mobile-notifications ul');
                    notificationBox.empty();
                    mobileNotifications.empty();
                    notifications.forEach(notification => {
                        const timeAgo = new Date(notification.createdAt).toLocaleString();
                        const notificationItem = `
                            <li class="p-2 rounded-end-3">
                                <a href="javascript:void(0)">
                                    <div class="d-flex align-items-center notification-row">
                                        <div class="d-flex align-items-center text-center p-0 notification-user-img">
                                            <img src="${notification.senderProfilePicture || '/includes/images/01.jpg'}" width="48" height="48" alt="">
                                        </div>
                                        <div class="notification-content">
                                            <div class="text-dark mb-0 fw-500 notification-msg">
                                                <span class="text-dark fw-bold mb-0">${notification.senderName || 'Unknown'}</span>
                                                <span class="fw-light fs-14">${notification.message || 'No message'}</span>
                                            </div>
                                            <p class="text-dark text-end mb-0 fs-12 fw-500">${timeAgo}</p>
                                        </div>
                                    </div>
                                </a>
                            </li>`;
                        notificationBox.append(notificationItem);
                        mobileNotifications.append(notificationItem);
                    });
                }
            },
            error: function (xhr) {
                if (xhr.status === 401) {
                    alert('Session expired. Please log in again.');
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('user');
                    window.location.href = '/index.html';
                }
            }
        });
    }

    function fetchMessages() {
        $.ajax({
            url: '/api/v1/messages',
            type: 'GET',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function (response) {
                if (response && response.data && Array.isArray(response.data)) {
                    const messages = response.data;
                    const messageBox = $('#message_box');
                    const mobileMessages = $('#mobile-messages ul');
                    messageBox.empty();
                    mobileMessages.empty();
                    messages.forEach(message => {
                        const timeAgo = new Date(message.createdAt).toLocaleString();
                        const messageItem = `
                            <li class="p-2 rounded-end-3">
                                <a href="javascript:void(0)">
                                    <div class="d-flex align-items-center notification-row">
                                        <div class="d-flex align-items-center text-center p-0 notification-user-img">
                                            <img src="${message.senderProfilePicture || '/includes/images/01.jpg'}" width="48" height="48" alt="">
                                        </div>
                                        <div class="notification-content">
                                            <div class="text-dark mb-0 fw-500 notification-msg">
                                                <span class="text-dark fw-bold mb-0">${message.senderName || 'Unknown'}</span>
                                            </div>
                                            <div class="d-flex justify-content-between">
                                                <div class="w-100 text-truncate fs-12 fw-500">${message.content || 'No content'}</div>
                                                <p class="text-dark text-end mb-0 fs-12 fw-500 msg-time">${timeAgo}</p>
                                            </div>
                                        </div>
                                    </div>
                                </a>
                            </li>`;
                        messageBox.append(messageItem);
                        mobileMessages.append(messageItem);
                    });
                }
            },
            error: function (xhr) {
                if (xhr.status === 401) {
                    alert('Session expired. Please log in again.');
                    localStorage.removeItem('access_token');
                    localStorage.removeItem('user');
                    window.location.href = '/index.html';
                }
            }
        });
    }

    fetchNotifications();
    fetchMessages();
    setInterval(() => {
        fetchNotifications();
        fetchMessages();
    }, 30000);

    $('.logout-btn').on('click', function(e) {
        e.preventDefault();
        $.ajax({
            url: '/api/v1/auth/logout',
            type: 'POST',
            headers: {
                'Authorization': 'Bearer ' + token
            },
            success: function(response) {
                localStorage.removeItem('access_token');
                localStorage.removeItem('user');
                updateUserStatus();
                window.location.href = '/index.html';
            },
            error: function(xhr) {
                alert('Logout failed: ' + (xhr.responseText || 'Unknown error'));
                localStorage.removeItem('access_token');
                localStorage.removeItem('user');
                updateUserStatus();
                window.location.href = '/index.html';
            }
        });
    });

    fetchProfessionalDetails();
});
    </script>
</body>

</html>